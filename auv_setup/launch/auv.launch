<?xml version="1.0"?>
<launch>
  <env name="ROSCONSOLE_FORMAT" value="[${severity}] [${time}] [${node}]: ${message}" />
  
  <!-- Input arguments -->
  <arg name="type" default="simulator"/> <!-- real | simulator -->
  <arg name="auv"  default="manta"/>     <!-- manta | gladlaks-->



  <!-- COMMON -->
  <include file="$(find rosbridge_server)/launch/rosbridge_websocket.launch"/>
  <rosparam command="load" file="$(find auv_setup)/config/environments/trondheim_freshwater.yaml"/>



  <!-- MANTA SPECIFIC-->
  <group if="$(eval auv == 'manta')">
    <!-- Load parameters -->
    <rosparam command="load" file="$(find auv_setup)/config/robots/manta_enu.yaml"/>
    <rosparam command="load" file="$(find auv_setup)/config/thrusters/thruster_terrapin.yaml" />

    <!-- Include files -->
    <include file="$(find motion_launch)/launch/motion.launch"            pass_all_args="true"/>
    <include file="$(find navigation_launch)/launch/navigation.launch"    pass_all_args="true"/>


    <!-- Launch IMU driver -->
    <node pkg = "driver_stim300" type = "stim300_driver_node" name = "driver_stim300" args="/dev/ttyUSB0"/>
    <!-- 0 0 0 3.14159 0 0 is the position and orientation of the IMU: In this case the IMU defines the center of the AUV -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_to_imu0" args="0 0 0 3.14159 0 0 base_link imu_0" />

    <!-- Launch DVL driver -->	
    <node pkg="dvl1000_ros" type="publisherDVL1000.py" name="publisherDVL1000" />
    <!-- -0.035 -0.017 -0.211 3.14159 3.14159 0 is the position and orientation of the DVL relative to the IMU -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_to_DVL" args="-0.035 -0.017 -0.211 3.14159 3.14159 0 base_link dvl_link" />

    <!-- Pressure data from the DVL is remapped to the origin, in this case the IMU position -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="odom_to_Pressure" args="0 0 0 0 0 0 odom pressure_link" />
  </group>
  


  <!-- GLADLAKS SPECIFIC -->
  <group if="$(eval auv == 'gladlaks')">
    <!-- Load parameters -->
    <rosparam command="load" file="$(find auv_setup)/config/robots/gladlaks.yaml"/>
    <rosparam command="load" file="$(find auv_setup)/config/thrusters/thruster_T200.yaml" />

    <!-- Include files -->
    <include file="$(find motion_launch)/launch/motion.launch"            pass_all_args="true"/>
    <include file="$(find navigation_launch)/launch/navigation.launch"    pass_all_args="true"/>


    <!-- Launch IMU driver -->
    <node pkg = "driver_stim300" type = "stim300_driver_node" name = "driver_stim300" args="/dev/ttyUSB0"/>
    <!-- 0 0 0 3.14159 0 0 is the position and orientation of the IMU: In this case the IMU defines the center of the AUV -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_to_imu0" args="0 0 0 3.14159 0 0 base_link imu_0" />

    <!-- Launch DVL driver -->	
    <node pkg="dvl1000_ros" type="publisherDVL1000.py" name="publisherDVL1000" />
    <!-- TODO is the position and orientation of the DVL relative to the IMU -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="base_link_to_DVL" args="TODO base_link dvl_link" />

    <!-- Pressure data from the DVL is remapped to the origin, in this case the IMU position -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="odom_to_Pressure" args="0 0 0 0 0 0 odom pressure_link" />
  </group>

</launch>
